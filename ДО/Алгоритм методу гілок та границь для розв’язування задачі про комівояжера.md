2024-05-28 : 13:21

## З лекції 
1. Побудова деякого довільного припустимого розв’язку задачі та
розрахунок значення критерію для нього
2. Послідовне розбиття біжучої множини маршрутів, що
залишилися, на все менші підмножини. Розбиття здійснюється шляхом
вибору дуги (i;j) та розбиття біжучої множини маршрутів на дві підмножини:

- таку, в яку включається ланка (i;j);
- таку, в яку ланка (i;j) не включається.

Для розбиттів обчислюється нижня границя довжини біжучого
найкращого маршруту та відтинаються неперспективні підмножини. В
залежності від включення (i;j) в маршрут забороняються всі маршрути, які
утворюють локальні контури. Нижня границя розраховується як приріст до
нижньої границі вузла-предка у випадку включення (i;j) до маршруту, або як
штраф за невключення у випадку$(i;j)^-$.
3. В результаті послідовних розбиттів будуємо повний маршрут
(тобто отримуємо біжучий розв’язок). Якщо отриманий розв’язок є кращим,
ніж біжучий найкращий розв’язок, то отриманий розв’язок стає біжучим
найкращим, і неперспективні вузли, які можуть з’явитися внаслідок цього,
відтинаються. В іншому випадку відтинається отриманий біжучий розв’язок
4. Якщо активних вузлів в дереві немає – стоп. Біжучий
найкращий розв’язок є оптимальним. В іншому випадку обираємо вузол з
найменшим значенням нижньої границі та переходимо до кроку 2

#### Розглянемо деталі реалізації окремих кроків алгоритму
Задана матриця:
![[Pasted image 20240528132408.png]]

Давайте візьмемо довільний маршрут. Нехай це буде
![[Pasted image 20240528132430.png]]

Для визначення нижньої границі використовуємо операцію редукції або
приведення матриці по рядках. Для цього необхідно в кожному рядку знайти
мінімальний елемент ![[Pasted image 20240528132447.png]]

![[Pasted image 20240528132501.png]]
Після цього віднімемо елементи $d_i$ по рядках.
Отримаємо наступну матрицю (в кожному рядку буде хоча б один нуль)
![[Pasted image 20240528132524.png]]

Тепер повторимо операцію редукції. Тільки тепер виконаємо її по
стовпцях матриці ![[Pasted image 20240528132540.png]]

![[Pasted image 20240528132548.png]]

Після віднімання по стовпцях, отримаємо повністю редуковану
матрицю, де величини $d_i$ та $d_j$ називаються **константами приведення**.

***Сума констант приведення утворює нижню границю H***
![[Pasted image 20240528132648.png]]

Оскільки ми маємо квадратну матрицю розмірами , то кожен
маршрут – це цикл,за яким комівояжер відвідує місто тільки один раз і
повертається в початкове місто. Довжина маршруту $d_ij$:
$F(M_k)=\Sigma d_ij$ , Де кожен рядок і стовпець входить лише один раз з одним з його
елементів  $d_ij$

**Крок 1**
Визначимо ребро та розгалузимо всю множину маршрутів на дві підмножини $(i, j)and(i^*, j^*)$, тобто те, що не беремо до розв'язку та беремо відповідно

Для цього для всіх нульових елементів матриці по черзі замінятимемо кожен нуль на безкінечність та будемо знаходити для них суму констант приведення(вони будуть показані в дужках)

![[Pasted image 20240531175738.png]]

Найбільша сума констант приведення рівна 12 для ребра (4; 3). Відповідно, множина розбивається на дві (4,3) та (4*,3*)

**Виключення ребра** проводимо шляхом заміни елемента (4,3) на безкінечність. Після чого приводимо матрицю відстаней для підмножини (4*,3*). В результаті отримаємо редуковану матрицю.

![[Pasted image 20240531175817.png]]

Нижня межа гамільтонових циклів цієї підмножини = 55.

**Включення ребра**. 
Тепер виключимо всі елементи четвертого рядка та третього стовпця, де замінимо елемент третього рядка та четвертого стовпця безкінечністю для виключення появи негамільтонових циклів. В результаті отримаємо скорочену матрицю розміром 4на4, яку треба привести. Після операції приведення наша матриця отримає вигляд:

![[Pasted image 20240531175907.png]]

Сума констант приведення скороченої матриці:
$$\sum d_i + \sum d_j = 7$$ $$H(4; 3) = \sum d_i + \sum d_j = 43 + 7 \leq 55$$
Оскільки нижня межа цього варіанту є меншою, ніж нижня межа (4*,3*), то ми включаємо ребро (4, 3) з новою межею 50

і т.д 

Після останньої операції приведення наша матриця отримає вигляд:

![[Pasted image 20240531180154.png]]

Сума констант приведення скороченої матриці:
$$\sum d_i + \sum d_j = 0$$
$$H(1; 5) = 50 + 0 \leq 55$$

Оскільки нижня межа цього варіанту є меншою, ніж нижня межа (1*,5*), то ми включаємо ребро (1, 5) з новою межею 50. 

Згідно з цією матрицею включаємо в гамільтонів маршрут ребра (2,4) та (3, 1). Результатом стали ребра (4,3), (3,1), (1,5), (5,2), (2,4). Довжина маршруту $F(M_k)=50$
## Від мене


## З Wiki
