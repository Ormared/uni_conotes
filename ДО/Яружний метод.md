[[00 - ДО питання до іспиту]]
## Опис
Англ.: Ravine method
Метод оптимізації першого порядку для гладкої опуклої мінімізації.

Яружний метод був створений для додатних коефіцієнітів екстраполяції $\gamma_k = \gamma > 0$. Останні досліди показали перевагу $\gamma_k = 1 - \frac{\alpha}{k}$, which for $\alpha \geq 3$ k , що при α ≥ 3, забезпечує асимптотичну швидкість збіжності, подібну до прискореного градієнтного методу Нестерова.[paper link](https://arxiv.org/pdf/2403.04860v1)    Він імітує потік води в горах, який спочатку швидко стікає вниз по схилу невеликими крутими(похилими) ярами, а потім тече вздовж головної річки в долині, звідси і назва методу. Геометричний методу прискореного градієнта яру наведено на рисунку  

![[Pasted image 20240529233134.png]]

**Використання:** прискорення збіжності, коли поверхні рівня функції цілі сильно витягнуті, тобто функція має яружний характер.

Ефективність яружного методу істотно зростає, якщо його крок $h$ обирати змінним, таким, щоб:
- прямолінійні ділянки на дні яру проходились швидше за рахунок збільшення яружного кроку
- на крутих поворотах уникнути викиду з яру і добитися меншого відхилення точок $\overline{x}^k$ від “дна“ за рахунок зменшення яружного кроку.

При статичному яружний метод втрачає свої переваги. 

## Механізм
1. Обираються дві довільні близькі точки $\overline{x}^0$ і $\overline{x}^1$, з яких одним кроком методу найшвидшого спуску чи іншим градієнтним методом виконуємо спуск і отримуються відповідно дві точки $х^0$ і $х^1$ в околі “дна яру“.
2. Знаходиться точка $\overline{x}^{k+1}(k=1,2,...)$ за формулою:
	$$
		\overline{x}^{k+1} = x^k-h\frac{x^{k}-x^{k-1}}{|x^{k}-x^{k-1}|}sign(\chi(x^{k}) - \chi(x^{k-1}))
	$$
		Величина $h$ - яружний крок(додатний)
$$
	h_{k+1} = h_k c^{\cos{\alpha_k} - \cos{\alpha_{k-1}}}, k = 2,3, ...
$$
	$$
		\cos{\alpha_k} = \frac{\left( \overline{x}^k - x^{k-1}, \overline{x}^k - x^{k-1} \right)}{\left| \overline{x}^k - x^{k-1} \right| \cdot \left| \overline{x}^k - x^{k-1} \right|}
	$$
3. Здійснюється спуск із точки і знаходиться наступна точка $\overline{х}^{k+1}$ на дні яру і знаходиться наступна точка $x^{k+1}$ 
4. Перевіряється виконання умови зупинки. Якщо вона не виконується, здійснюється перехід до **п. 3**, якщо виконується, за розв'язок обирається $х^{k+1}$

Від правильного вибору яружного кроку істотно залежить швидкість збіжності методу.
Якщо крок дуже малий, то кількість обчислень набагато збільшується і пошук сильно уповільнюється, тобто ефект від застосування яружного методу стає незначним

Якщо ж крок занадто великий, то на крутих поворотах яру точки $х^{k}$ можуть:
- занадто віддалятися від дна, тоді спуск з точки в точку $х^k$ потребує великого обсягу обчислень;
- бути викинутим за межі яру, тоді правильний напрямок пошуку мінімуму буде загублено.

Для цього пропонується задавати яружний крок у такий спосіб:
$$
	h_{k+1} = h_k c^{\cos{\alpha_k} - \cos{\alpha_{k-1}}}, k = 2,3, ...
$$
		де $\alpha_k$ кут між векторами $\overline{x}^k - x^{k-1}$ й $x^k - x^{k-1}$, який визначається формулою 
	$$
		\cos{\alpha_k} = \frac{\left( \overline{x}^k - x^{k-1}, \overline{x}^k - x^{k-1} \right)}{\left| \overline{x}^k - x^{k-1} \right| \cdot \left| \overline{x}^k - x^{k-1} \right|}
	$$
## Формули
Точка
$$
		\overline{x}^{k+1} = x^k-h\frac{x^{k}-x^{k-1}}{|x^{k}-x^{k-1}|}sign(\chi(x^{k-1}))
$$

Крок
$$
	h_{k+1} = h_k c^{\cos{\alpha_k} - \cos{\alpha_{k-1}}}, k = 2,3, ...
$$

Косинус кута між векторами 
$$
		\cos{\alpha_k} = \frac{\left( \overline{x}^k - x^{k-1}, \overline{x}^k - x^{k-1} \right)}{\left| \overline{x}^k - x^{k-1} \right| \cdot \left| \overline{x}^k - x^{k-1} \right|}
	$$

## Ремарки
Треба добавити пояснення chu і sign

Прикольно, коли єдину згадку про метод в інтернеті можна найти лише в пдфках та пайперах. Пейпер ще каже, що цей метод помер і недавно воскрес. Цікаво, без жарту, підвищує відчуття духу пригод.

